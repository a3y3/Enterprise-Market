$(document).ready(function(){
	if($("body").hasClass("rfqs new")){
		$("#btn-post-rfq").on("click", function(e){
			var input_term = $("#commodities-search").val();
			var option = $(".searchable-option[value='"+ input_term + "']");

			if(option.length != 0){
				alert(option.data("value"));
				$("#commodity_type_id").attr("value", option.data("value"));
			}
			else{
				alert("We don't provide the commodity you searched for, yet!");
				e.preventDefault();
			}
		});
		$("#commodities-input-rfq-new").on("keyup", function(){
			//remove all existing children
			var dataList = document.getElementById("commodities-datalist-rfq-new");
			var input = $(this);
			while(dataList.lastChild){
				dataList.removeChild(dataList.lastChild);
			}
			$.ajax({
		    url: "/commodities/search",
		    type: "GET",
		    dataType: "json",
		    data: {
		      'input': input.val()
		    	},
		    success: function (data, status, jqXHR) {
					var jsonData = JSON.parse(data.data);
		      jsonData.forEach(function(item){
		      	var option = document.createElement("option");
		      	option.setAttribute("value", item.name);
		      	option.setAttribute("data-value", item.id);
		      	option.setAttribute("class", "searchable-option");
		      	dataList.appendChild(option);
		      });
		    },
		    error: function (jqXHR, status, err) {
		      console.log("Error" + err);
		    }
		  });
		});
		$();
	}
});